.container
  .row{style: "margin-top: 40px;"}
    .row
      %h2
        .col-md-4
          Edit Settings
        .col-md-8
          %form{action: "/logout", method: "post"}
            %input{type: "submit", class: "btn btn-default pull-right", value: "Log Out"}
    %hr

    %form{action: "/settings/email", method: "post", role: "form"}
      .form-group
        .row
          .col-md-3
            %label{for: "email"} Email
        .row
          .col-md-3
            %input{type: "email", id: "email", name: "email", class: "form-control", value: "#{@user.email}", required: "required"}
          .col-md-2
            %input{class: "btn btn-primary", type: "submit", value:"Update Email"}

    %hr

    %form{action: "/settings/password", method: "post", role: "form"}
      .form-group
        .row
          .col-md-3
            %label{for: "current_password"} Current Password
          .col-md-3
            %label{for: "password"} New Password
          .col-md-3
            %label{for: "confirm_password"} Confirm New Password
        .row
          .col-md-3
            %input{type: "password", id: "current_password", name: "current_password", class: "form-control", autocomplete: "off", required: "required"}
          .col-md-3
            %input{type: "password", id: "new_password", name: "new_password", class: "form-control", required: "required"}
          .col-md-3
            %input{type: "password", id: "confirm_password", name: "confirm_password", class: "form-control", required: "required"}
          .col-md-3
            %input{class: "btn btn-primary", type: "submit", value:"Change Password"}

  %hr


  %a{id: "trelloDisconnect", class: "btn btn-lg btn-warning", onClick: "disconnect()"}
    Disconnect #{@trello_name} from Trello
  %a{id: "trelloConnect", class: "btn btn-primary btn-lg", href: "javascript:void(0)", onClick: "connect()"}
    Connect with Trello
  %span{id: "trelloConnectStatus"}
    %image{src: '../img/loading.gif'}

  %hr

  %form{action: "/settings/delete", method: "post"}
    .checkbox{style: "font-size: 16px;"}
      %label
        %input{type: "checkbox", name: "iamsure"}
          This box verifies that you would like to delete your account when clicking the link below.
    %input{type: "submit", id: "deleteAccountButton", class: "btn btn-defualt btn-danger", value: "Delete Account"}

:javascript
  $(document).ready(function() {
    if (#{@user.member_token.nil?}) {
      $("#trelloConnect").show();
    } else {
      $("#trelloDisconnect").show();
    }
  })

  function disconnect() {
    $.ajax({
      url: "/settings/trello/disconnect",
      method: "PUT",
      success: function() {
        $("#trelloDisconnect").hide();
        $("#trelloConnect").show();
      },
      done: function() {
        // stop showing spinner
      }
    });
  }

  function connect() {
    var onSuccess = function() {
      $.ajax({
        url: "/settings/trello/connect",
        data: {token: Trello.token()},
        method: "PUT",
        success: function() {
          $("#trelloConnect").hide();
          $("#trelloDisconnect").show();
        },
        done: function() {
          // stop showing spinner
        }
      });
    }
    AuthorizeTrello("never", onSuccess)
  }
  